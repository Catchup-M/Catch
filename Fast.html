<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Telegram Chat Hybrid</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body, html, #root {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden; /* Prevent body scroll */
    }

    /* --- Chat Structure Positioning (Full Screen) --- */
    .app-container {
      height: 100%;
      display: flex;
      flex-direction: column;
      position: relative; /* Context for children */
      overflow: hidden;
    }

    .conversation-list {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: #fff;
      transition: transform 0.3s;
      z-index: 1;
    }

    .conversation-list.-translate-x-full {
      transform: translateX(-100%);
    }

    /* Primary Chat View container */
    .chat-view {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: #f5f5f5;
      transition: transform 0.3s;
      transform: translateX(100%);
      z-index: 2;
      display: flex;
      flex-direction: column;
    }

    .chat-view.translate-x-0 {
      transform: translateX(0);
    }

    /* --- Scroll Container & Content --- */
    .chat-scroll-container {
      flex: 1; /* Takes up remaining height */
      background-image: url(https://i.ibb.co/fzG6R49y/Screenshot-20251125-105049.jpg);
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      overflow-y: auto; /* THIS is the main scroll region */
      overflow-x: hidden;
      display: flex;
      flex-direction: column;
      
      /* KEY for sticky: Overscroll behavior to prevent scrolling past sticky footer */
      /* This is a fallback and not always necessary but good practice */
      -webkit-overflow-scrolling: touch; 
    }

    .chat-content-padding {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: flex-end; /* Push messages to the bottom */
      padding: 16px;
      /* Padding-bottom is no longer needed since the footer is inside and sticky */
      min-height: 100%; /* Important for initial display */
    }

    /* --- Hybrid Footer (Sticky) --- */
    .footer {
      /* Removed fixed positioning */
      position: sticky; 
      bottom: 0; /* Sticks to the bottom of the scroll container */
      width: 100%;
      
      background: #fff;
      padding: 5px 10px;
      display: flex;
      align-items: center;
      border-top: 1px solid #e5e5e5; /* Optional separation line */
      box-shadow: 0 -1px 4px rgba(0,0,0,0.05);
      z-index: 10;
      height: 56px;
      flex-shrink: 0; /* Prevent it from shrinking */
    }
    
    /* The emoji picker is fixed/absolute relative to chat-view, not the scroll content */
    .emoji-picker {
      position: absolute; /* Changed from fixed to absolute within chat-view */
      bottom: 0; /* Initially placed below the footer's space */
      left: 0;
      right: 0;
      height: 300px;
      background: #f5f5f5;
      transition: transform 0.3s ease;
      transform: translateY(100%); /* Hidden below the screen bottom */
      z-index: 8;
      border-top: 1px solid #e5e5e5;
    }

    .emoji-picker.show {
      /* When shown, it covers the input bar and extends 300px up */
      transform: translateY(-300px); 
    }
    
    .footer.emoji-open {
      /* No longer controls position, just an indicator if needed */
    }


    /* --- General Styling (Rest of CSS kept the same) --- */
    .footer svg.left-icon, .footer svg.right-icon {
      width: 25px;
      height: 29px;
      margin-right: 10px;
      flex-shrink: 0;
      fill: #666666;
      cursor: pointer;
    }
    
    .footer svg.right-icon {
      margin-right: 0;
      margin-left: 10px;
    }

    .input-box-wrapper {
      flex: 1;
      display: flex;
      align-items: center;
      background: #f1f1f1;
      border-radius: 20px;
      padding: 8px 10px;
      min-height: 43px;
      max-height: 120px;
      box-sizing: border-box;
      overflow: hidden;
    }

    .input-box-wrapper svg {
      width: 21px;
      height: 21px;
      flex-shrink: 0;
      margin-right: 10px;
    }

    .input-box {
      flex: 1;
      font-size: 14px;
      line-height: 1.4;
      outline: none;
      border: none;
      background: transparent;
      min-height: 20px;
      max-height: 100px;
      overflow-y: auto;
      word-wrap: break-word;
      white-space: pre-wrap;
      overflow-x: hidden;
      width: 100%;
    }

    .input-box:empty:before {
      content: "Message";
      color: #aaa;
      pointer-events: none;
    }

    .input-box:focus:empty:before {
      content: "Message";
      color: #aaa;
    }

    .sticky-date {
      position: fixed;
      top: 60px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 15;
      opacity: 0;
      transition: opacity 0.2s ease;
      pointer-events: none;
    }

    .sticky-date.visible {
      opacity: 1;
    }

    .sticky-date .date-badge {
      background: rgba(0, 0, 0, 0.7);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    .sticky-date:empty {
      display: none;
    }

    .message-date-badge {
      display: flex;
      justify-content: center;
      padding: 8px 0;
      margin-bottom: 8px;
    }

    .message-date-badge .date-badge {
      background: rgba(0, 0, 0, 0.6);
      color: white;
      padding: 4px 10px;
      border-radius: 10px;
      font-size: 12px;
      font-weight: 500;
      backdrop-filter: blur(10px);
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useRef, useEffect } = React;

    function FooterChatBar() {
      const [isKeyboardActive, setIsKeyboardActive] = useState(false);
      const [showChat, setShowChat] = useState(false);
      const [hasText, setHasText] = useState(false);
      const [showEmojiPicker, setShowEmojiPicker] = useState(false);
      const [messages, setMessages] = useState([
        { id: 1, type: 'image', imageUrl: 'https://i.ibb.co/fKxWKb3/Screenshot-20251129-120749.jpg', time: '17:06', sent: true, date: 'Tuesday' },
        { id: 2, text: 'This is a test message to push the scroll height and demonstrate the sticky input bar functionality when the content is tall enough.', time: '17:07', sent: true },
        { id: 3, text: 'The sticky footer now scrolls with the content, providing a better experience on mobile browsers and handling the keyboard better.', time: '17:07', sent: true },
        { id: 4, text: 'It prevents the footer from jumping or covering essential content when the mobile keyboard slides up, as the browser automatically adjusts the scroll container (which now contains the sticky footer).', time: '17:07', sent: true }
      ]);
      const inputRef = useRef(null);
      const chatContainerRef = useRef(null);
      const stickyDateRef = useRef(null);

      const toggleKeyboard = () => {
        // Toggle logic: If showing emoji, hide emoji and switch to keyboard mode (input focus).
        if (showEmojiPicker) {
            setShowEmojiPicker(false);
            setIsKeyboardActive(false);
            // Need to focus the input to trigger the actual keyboard
            if (inputRef.current) {
                setTimeout(() => inputRef.current.focus(), 300); // Delay focus after transition
            }
        } else {
            // If showing keyboard, hide keyboard, show emoji picker
            setShowEmojiPicker(true);
            setIsKeyboardActive(true); // Technically not keyboard, but indicator of text mode
            if (inputRef.current) {
                inputRef.current.blur(); // Blur to hide software keyboard
            }
        }
      };

      const openChat = () => {
        setShowChat(true);
      };

      const closeChat = () => {
        setShowChat(false);
        // Clear state when leaving chat
        setShowEmojiPicker(false);
        setIsKeyboardActive(false);
      };

      const handleInputClick = () => {
        // When clicking input, close emoji picker if it's open, and let the native keyboard open
        if (showEmojiPicker) {
          setShowEmojiPicker(false);
          setIsKeyboardActive(false);
        }
        
        // Scroll to the bottom to ensure the input is visible above the keyboard
        const scrollToBottom = () => {
          if (chatContainerRef.current) {
            // Scroll to the bottom of the scroll container
            chatContainerRef.current.scrollTop = chatContainerRef.current.scrollHeight;
          }
        };
        
        // Immediate scroll + delayed scrolls to catch keyboard appearance
        scrollToBottom();
        setTimeout(scrollToBottom, 100);
        setTimeout(scrollToBottom, 300);
      };

      const handleInput = (e) => {
        const text = e.currentTarget.textContent.trim();
        setHasText(text.length > 0);
        
        // Scroll to bottom while typing (optional, often handled natively)
        setTimeout(() => {
          if (chatContainerRef.current) {
            chatContainerRef.current.scrollTop = chatContainerRef.current.scrollHeight;
          }
        }, 50);
      };

      const handleBlur = (e) => {
        if (e.currentTarget.textContent.trim() === '') {
          e.currentTarget.textContent = '';
        }
      };

      const handleSend = () => {
        if (inputRef.current && hasText) {
          const text = inputRef.current.textContent.trim();
          if (text) {
            const newMessage = {
              id: messages.length + 1,
              text: text,
              time: new Date().toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' }),
              sent: true
            };
            setMessages([...messages, newMessage]);
          }
          inputRef.current.innerHTML = '';
          setHasText(false);
          // Keep focus if user is rapid-sending, but blur to ensure scrolling is correct on some devices
          // inputRef.current.blur(); 
        }
      };

      // Auto-scroll to bottom when new messages arrive or chat opens
      useEffect(() => {
        if (showChat) {
          const scrollToBottom = () => {
            if (chatContainerRef.current) {
              chatContainerRef.current.scrollTop = chatContainerRef.current.scrollHeight;
            }
          };
          // Give layout time to render new messages
          setTimeout(scrollToBottom, 50);
        }
      }, [messages, showChat]);

      // Scroll management is simplified because the sticky footer is naturally pushed up by the keyboard.
      // Sticky Date logic remains the same (as it is fixed relative to the viewport).
      useEffect(() => {
        const scrollContainer = chatContainerRef.current;
        if (!scrollContainer || !showChat) return;

        const handleScroll = () => {
          const dateSeparators = scrollContainer.querySelectorAll('.message-date-badge');
          const stickyDate = stickyDateRef.current;
          if (!stickyDate) return;

          let shouldShowSticky = false;
          let currentDateText = '';
          const chatHeaderHeight = 65;

          // Find the last date separator that has scrolled past the header
          for (let i = dateSeparators.length - 1; i >= 0; i--) {
              const separator = dateSeparators[i];
              const rect = separator.getBoundingClientRect();
              
              if (rect.top <= chatHeaderHeight) {
                shouldShowSticky = true;
                const badge = separator.querySelector('.date-badge');
                if (badge) {
                  currentDateText = badge.textContent;
                  break;
                }
              }
          }

          const stickyBadge = stickyDate.querySelector('.date-badge');
          if (shouldShowSticky && currentDateText && stickyBadge) {
            stickyBadge.textContent = currentDateText;
            stickyDate.classList.add('visible');
          } else {
            if (stickyBadge) stickyBadge.textContent = '';
            stickyDate.classList.remove('visible');
          }
        };

        scrollContainer.addEventListener('scroll', handleScroll);
        setTimeout(handleScroll, 100);
        
        return () => scrollContainer.removeEventListener('scroll', handleScroll);
      }, [showChat, messages]);

      return (
        <div className="app-container" style={{ fontFamily: 'Arial, sans-serif' }}>
          {/* Conversation List */}
          <div className={`conversation-list ${showChat ? '-translate-x-full' : ''}`}>
            {/* ... Conversation List Header/Items (Unchanged) ... */}
            <div style={{ background: '#fff', borderBottom: '1px solid #e5e5e5' }}>
              <div style={{ display: 'flex', alignItems: 'center', padding: '12px 16px', gap: '12px' }}>
                <button style={{ padding: '6px', background: 'transparent', border: 'none', cursor: 'pointer' }}>
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#666" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                  </svg>
                </button>
                <div style={{ flex: 1, display: 'flex', alignItems: 'center', background: '#f5f5f5', borderRadius: '20px', padding: '10px 16px', gap: '8px' }}>
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#999" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                  </svg>
                  <input 
                    type="text" 
                    placeholder="Search" 
                    style={{ flex: 1, background: 'transparent', border: 'none', outline: 'none', fontSize: '16px', color: '#333' }}
                  />
                </div>
              </div>
            </div>

            <div 
              onClick={openChat}
              style={{ 
                display: 'flex', 
                alignItems: 'center', 
                padding: '12px 16px', 
                gap: '12px', 
                cursor: 'pointer',
                position: 'relative'
              }}
            >
              <div style={{ 
                width: '52px', 
                height: '52px', 
                borderRadius: '50%', 
                background: '#fb923c', 
                display: 'flex', 
                alignItems: 'center', 
                justifyContent: 'center', 
                flexShrink: 0 
              }}>
                <span style={{ color: 'white', fontSize: '20px', fontWeight: '600' }}>DS</span>
              </div>
              <div style={{ flex: 1, minWidth: 0, position: 'relative' }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'baseline', marginBottom: '4px' }}>
                  <h3 style={{ fontWeight: '600', color: '#111', fontSize: '16px', margin: 0 }}>Daddy Steve</h3>
                  <span style={{ color: '#999', fontSize: '13px', flexShrink: 0 }}>Oct 27</span>
                </div>
                <p style={{ color: '#666', fontSize: '14px', margin: 0, overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
                  Daddy Steve joined Telegram
                </p>
                <div style={{ 
                  position: 'absolute', 
                  bottom: '-12px', 
                  left: 0, 
                  right: '-16px', 
                  height: '1px', 
                  background: '#f0f0f0' 
                }}></div>
              </div>
            </div>
          </div>

          {/* Chat View */}
          <div className={`chat-view ${showChat ? 'translate-x-0' : ''}`}>
            {/* Chat Header (Fixed at top) */}
            <div style={{ background: '#fff', borderBottom: '1px solid #e5e5e5', flexShrink: 0 }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '8px', padding: '8px' }}>
                <button 
                  onClick={closeChat}
                  style={{ padding: '6px', background: 'transparent', border: 'none', cursor: 'pointer', borderRadius: '4px' }}
                >
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#6b7280" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <line x1="19" y1="12" x2="5" y2="12"></line>
                    <polyline points="12 19 5 12 12 5"></polyline>
                  </svg>
                </button>
                <div style={{ width: '40px', height: '40px', borderRadius: '50%', background: '#fb923c', display: 'flex', alignItems: 'center', justifyContent: 'center', flexShrink: 0 }}>
                  <span style={{ color: 'white', fontSize: '16px', fontWeight: '600' }}>DS</span>
                </div>
                <div style={{ flex: 1, minWidth: 0 }}>
                  <h3 style={{ fontWeight: '600', color: '#111827', fontSize: '18px', margin: 0 }}>Daddy Steve</h3>
                  <p style={{ color: '#6b7280', fontSize: '14px', margin: 0 }}>last seen 11/3/2025</p>
                </div>
                <button style={{ padding: '6px', background: 'transparent', border: 'none', cursor: 'pointer', borderRadius: '4px' }}>
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#6b7280" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <circle cx="12" cy="12" r="1"></circle>
                    <circle cx="12" cy="5" r="1"></circle>
                    <circle cx="12" cy="19" r="1"></circle>
                  </svg>
                </button>
              </div>
            </div>

            {/* Sticky Date at Top */}
            <div className="sticky-date" ref={stickyDateRef}>
              <div className="date-badge"></div>
            </div>

            {/* Scroll Container (Chat Content + Sticky Footer) */}
            <div ref={chatContainerRef} className="chat-scroll-container">
              
              {/* Message Content (Pushed to bottom using flex) */}
              <div className="chat-content-padding" style={{ 
                gap: '8px',
              }}>
              {messages.map((message) => {
                // ... Message rendering logic remains the same
                if (message.type === 'image') {
                  return (
                    <React.Fragment key={message.id}>
                      {message.date && (
                        <div className="message-date-badge">
                          <div className="date-badge">{message.date}</div>
                        </div>
                      )}
                      <div style={{ display: 'flex', justifyContent: 'flex-end' }}>
                        <div style={{ 
                          background: 'white', 
                          borderRadius: '16px 1px 1px 16px', 
                          padding: '4px',
                          boxShadow: '0 1px 2px rgba(0,0,0,0.1)',
                          maxWidth: '290px',
                          position: 'relative'
                        }}>
                          <img 
                            src={message.imageUrl} 
                            alt="Sent image" 
                            style={{ 
                              width: '100%', 
                              display: 'block', 
                              borderRadius: '12px',
                              maxWidth: '290px'
                            }} 
                          />
                          <div style={{ 
                            position: 'absolute',
                            bottom: '12px',
                            right: '12px',
                            fontSize: '11px',
                            color: 'white',
                            textShadow: '0 1px 2px rgba(0,0,0,0.6)',
                            display: 'flex',
                            alignItems: 'center',
                            gap: '4px'
                          }}>
                            {message.time}
                            {message.sent && (
                              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 32 32" style={{ filter: 'drop-shadow(0 1px 2px rgba(0,0,0,0.6))' }}>
                                <path fill="none" stroke="white" strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="m6.5 17l6 6l13-13"/>
                              </svg>
                            )}
                          </div>
                        </div>
                      </div>
                    </React.Fragment>
                  );
                }
                
                const isLongMessage = message.text.length > 50;
                const isMediumMessage = message.text.length > 30 && message.text.length <= 50;
                
                return (
                  <div key={message.id} style={{ display: 'flex', justifyContent: 'flex-end' }}>
                    {isLongMessage ? (
                      <div style={{ 
                        background: 'white', 
                        borderRadius: '16px 1px 1px 16px', 
                        padding: '8px 12px 4px 12px',
                        boxShadow: '0 1px 2px rgba(0,0,0,0.1)',
                        maxWidth: '290px'
                      }}>
                        <div style={{ fontSize: '14px', lineHeight: '1.3', color: '#111' }}>
                          {message.text}
                          <span style={{ 
                            float: 'right', 
                            marginLeft: '6px',
                            fontSize: '11px',
                            color: '#6b7280',
                            whiteSpace: 'nowrap',
                            display: 'inline-flex',
                            alignItems: 'center',
                            gap: '4px',
                            position: 'relative',
                            bottom: '-5px'
                          }}>
                            {message.time}
                            {message.sent && (
                              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 32 32" style={{ position: 'relative', top: '-2px' }}>
                                <path fill="none" stroke="#808080" strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="m6.5 17l6 6l13-13"/>
                              </svg>
                            )}
                          </span>
                        </div>
                      </div>
                    ) : isMediumMessage ? (
                      <div style={{ 
                        background: 'white', 
                        borderRadius: '16px 1px 1px 16px', 
                        padding: '8px 12px 4px 12px',
                        boxShadow: '0 1px 2px rgba(0,0,0,0.1)',
                        maxWidth: '85%'
                      }}>
                        <div style={{ fontSize: '14px', lineHeight: '1.3', color: '#111' }}>
                          {message.text}
                          <span style={{ 
                            float: 'right', 
                            marginLeft: '6px',
                            fontSize: '11px',
                            color: '#6b7280',
                            whiteSpace: 'nowrap',
                            display: 'inline-flex',
                            alignItems: 'center',
                            gap: '4px',
                            position: 'relative',
                            bottom: '-5px'
                          }}>
                            {message.time}
                            {message.sent && (
                              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 32 32" style={{ position: 'relative', top: '-2px' }}>
                                <path fill="none" stroke="#808080" strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="m6.5 17l6 6l13-13"/>
                              </svg>
                            )}
                          </span>
                        </div>
                      </div>
                    ) : (
                      <div style={{ 
                        background: 'white', 
                        borderRadius: '16px 1px 1px 16px', 
                        padding: '8px 12px',
                        boxShadow: '0 1px 2px rgba(0,0,0,0.1)',
                        maxWidth: '85%'
                      }}>
                        <div style={{ display: 'flex', alignItems: 'flex-end', gap: '8px', whiteSpace: 'nowrap' }}>
                          <span style={{ color: '#111', fontSize: '14px' }}>{message.text}</span>
                          <span style={{ 
                            fontSize: '11px', 
                            color: '#6b7280', 
                            display: 'flex', 
                            alignItems: 'center', 
                            gap: '4px',
                            flexShrink: 0
                          }}>
                            {message.time}
                            {message.sent && (
                              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 32 32" style={{ position: 'relative', top: '-1px' }}>
                                <path fill="none" stroke="#808080" strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="m6.5 17l6 6l13-13"/>
                              </svg>
                            )}
                          </span>
                        </div>
                      </div>
                    )}
                  </div>
                );
              })}
              </div>
              
              {/* Hybrid Chat Footer (Sticky at the bottom of the scroll container) */}
              <div className="footer">
                <svg className="left-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <g className="attachment-clip-outline">
                    <path fill="#666666" fillRule="evenodd" d="M8 7.308c0-.558.186-1.434.659-2.14C9.1 4.504 9.779 4 10.88 4c1.134 0 1.88.499 2.373 1.155c.52.692.746 1.555.746 2.153v7.54a.8.8 0 0 1-.073.223c-.065.141-.166.3-.3.447c-.269.295-.61.482-1.002.482c-.436 0-.777-.18-1.02-.433c-.263-.274-.355-.574-.355-.72v-7.56a1 1 0 0 0-2 0v7.56c0 .75.358 1.527.912 2.105A3.38 3.38 0 0 0 12.625 18c1.085 0 1.93-.532 2.48-1.134c.517-.567.895-1.335.895-2.02V7.308c0-1.001-.35-2.292-1.146-3.354C14.029 2.856 12.716 2 10.88 2c-1.867 0-3.13.925-3.885 2.055A6.13 6.13 0 0 0 6 7.308v8.695C6 19.402 9.003 22 12.5 22c3.498 0 6.5-2.597 6.5-5.997V7a1 1 0 1 0-2 0v9.003C17 18.123 15.079 20 12.5 20C9.923 20 8 18.122 8 16.003z" className="Vector" clipRule="evenodd"/>
                  </g>
                </svg>

                <div className="input-box-wrapper">
                  {isKeyboardActive ? (
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 432 384" onClick={toggleKeyboard} style={{ cursor: 'pointer' }}>
                      <path fill="#666666" d="M384 43q18 0 30.5 12.5T427 85v214q0 17-12.5 29.5T384 341H43q-18 0-30.5-12.5T0 299V85q0-17 12.5-29.5T43 43h341zm-192 64v42h43v-42h-43zm0 64v42h43v-42h-43zm-64-64v42h43v-42h-43zm0 64v42h43v-42h-43zm-21 42v-42H64v42h43zm0-64v-42H64v42h43zm192 150v-43H128v43h171zm0-86v-42h-43v42h43zm0-64v-42h-43v42h43zm64 64v-42h-43v42h43zm0-64v-42h-43v42h43z"/>
                    </svg>
                  ) : (
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" onClick={toggleKeyboard} style={{ cursor: 'pointer' }}>
                      <path fill="#666666" d="M464 256a208 208 0 1 0-416 0a208 208 0 1 0 416 0M0 256a256 256 0 1 1 512 0a256 256 0 1 1-512 0m177.3 63.4c15 15.6 41.1 32.6 78.7 32.6s63.7-17 78.7-32.6c9.2-9.6 24.4-9.9 33.9-.7s9.9 24.4.7 33.9c-22.1 23-60 47.4-113.3 47.4s-91.2-24.4-113.3-47.4c-9.2-9.6-8.9-24.8.7-33.9s24.8-8.9 33.9.7M144 208a32 32 0 1 1 64 0a32 32 0 1 1-64 0m192-32a32 32 0 1 1 0 64a32 32 0 1 1 0-64"/>
                    </svg>
                  )}
                  <div 
                    ref={inputRef}
                    className="input-box" 
                    contentEditable="true"
                    onInput={handleInput}
                    onBlur={handleBlur}
                    onClick={handleInputClick}
                    onFocus={handleInputClick}
                    suppressContentEditableWarning={true}
                  ></div>
                </div>

                {!hasText && (
                  <svg 
                    className="right-icon" 
                    xmlns="http://www.w3.org/2000/svg" 
                    viewBox="0 0 14 14"
                  >
                    <g fill="none" stroke="#666666" strokeLinecap="round" strokeLinejoin="round">
                      <path d="M9.5 6.5a2.5 2.5 0 0 1-5 0V3a2.5 2.5 0 0 1 5 0Z"/>
                      <path d="M12 7h0a4.49 4.49 0 0 1-4.5 4.5h-1A4.49 4.49 0 0 1 2 7h0m5 4.5v2"/>
                    </g>
                  </svg>
                )}

                {hasText && (
                  <button 
                    onClick={handleSend}
                    style={{
                      background: 'transparent',
                      border: 'none',
                      cursor: 'pointer',
                      width: '25px',
                      height: '29px',
                      marginLeft: '10px',
                      flexShrink: 0,
                      display: 'flex',
                      alignItems: 'center',
                      justifyContent: 'center'
                    }}
                  >
                    <svg viewBox="0 -0.5 21 21" width="29" height="29" xmlns="http://www.w3.org/2000/svg">
                      <path d="M2.61258 9L0.05132 1.31623C-0.22718 0.48074 0.63218 -0.28074 1.42809 0.09626L20.4281 9.0963C21.1906 9.4575 21.1906 10.5425 20.4281 10.9037L1.42809 19.9037C0.63218 20.2807 -0.22718 19.5193 0.05132 18.6838L2.61258 11H8.9873C9.5396 11 9.9873 10.5523 9.9873 10C9.9873 9.4477 9.5396 9 8.9873 9H2.61258z" fill="#3b82f6" fillRule="evenodd" clipRule="evenodd" />
                    </svg>
                  </button>
                )}
              </div>
            </div>
            
            {/* Emoji Picker Bottom Sheet (Absolute relative to Chat View) */}
            <div className={`emoji-picker ${showEmojiPicker ? 'show' : ''}`}>
            </div>

          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<FooterChatBar />);
  </script>
</body>
</html>

