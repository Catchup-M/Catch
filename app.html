<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Telegram Chat</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/umd/lucide.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    [contenteditable][data-empty="true"]:empty:before {
      content: attr(data-placeholder);
      color: #9ca3af;
      pointer-events: none;
    }
    .hide-scrollbar::-webkit-scrollbar { display: none; }
    .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    html, body { 
      overflow: hidden; 
      height: 100%; 
      height: 100dvh;
      margin: 0;
      padding: 0;
    }
    #root {
      height: 100%;
      height: 100dvh;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useRef, useEffect } = React;
    const { ArrowLeft, MoreVertical } = lucide;

    function TelegramNotification() {
      const [showChat, setShowChat] = useState(false);
      const [showEmojiPicker, setShowEmojiPicker] = useState(false);
      const [hasText, setHasText] = useState(false);
      const [replyingTo, setReplyingTo] = useState(null);
      const [showScrollButton, setShowScrollButton] = useState(false);
      const [lastScrollTop, setLastScrollTop] = useState(0);
      const [messages, setMessages] = useState([
        { id: 1, text: 'How', time: '17:32' },
        { id: 2, text: 'How are you doing', time: '17:32' },
        { id: 3, text: 'How are you doing today bro', time: '17:33' },
        { id: 4, text: 'How are you feeling today bro', time: '17:33' },
        { id: 5, text: 'How are you copping today my nigga Gee', time: '17:33' },
        { id: 6, text: 'Hey bro how are you doing my dear hope everything is going well and', time: '10:05 AM' }
      ]);

      const inputRef = useRef(null);
      const chatAreaRef = useRef(null);
      const emojiPickerHeight = '300px';

      const scrollToBottom = (smooth = true) => {
        setTimeout(() => {
          if (chatAreaRef.current) {
            chatAreaRef.current.scrollTop = chatAreaRef.current.scrollHeight + 1000;
          }
        }, 50);
      };

      const handleScroll = () => {
        if (!chatAreaRef.current) return;
        const { scrollTop, scrollHeight, clientHeight } = chatAreaRef.current;
        const distanceFromBottom = scrollHeight - scrollTop - clientHeight;
        const isScrollingDown = scrollTop > lastScrollTop;

        setLastScrollTop(scrollTop);

        if (isScrollingDown && distanceFromBottom > 150) {
          setShowScrollButton(true);
        } else if (distanceFromBottom < 50) {
          setShowScrollButton(false);
        } else if (!isScrollingDown) {
          setShowScrollButton(false);
        }
      };

      useEffect(() => {
        scrollToBottom(false);
      }, [messages]);

      useEffect(() => {
        if (showEmojiPicker) {
          setTimeout(() => scrollToBottom(true), 200);
        }
      }, [showEmojiPicker]);

      const toggleEmojiPicker = () => {
        setShowEmojiPicker(!showEmojiPicker);
      };

      const handleFocus = () => {
        if (inputRef.current) {
          const isEmpty = inputRef.current.textContent?.trim() === '';
          inputRef.current.setAttribute('data-empty', isEmpty.toString());
        }
        setShowEmojiPicker(false);
        setTimeout(() => {
          if (chatAreaRef.current) {
            chatAreaRef.current.scrollTop = chatAreaRef.current.scrollHeight + 1000;
          }
        }, 500);
      };

      const handleClick = () => {
        if (inputRef.current) {
          const isEmpty = inputRef.current.textContent?.trim() === '';
          inputRef.current.setAttribute('data-empty', isEmpty.toString());
        }
      };

      const handleInput = (e) => {
        const text = e.currentTarget.textContent?.trim() || '';
        setHasText(text.length > 0);
        e.currentTarget.setAttribute('data-empty', text === '' ? 'true' : 'false');
      };

      const handleKeyDown = (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          handleSend();
        }
      };

      const handleSend = () => {
        if (!inputRef.current) return;
        const text = inputRef.current.textContent?.trim() || '';
        if (text.length === 0) return;

        const now = new Date();
        const time = now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });

        setMessages(prev => [...prev, { id: Date.now(), text, time }]);
        inputRef.current.textContent = '';
        inputRef.current.innerHTML = '';
        setHasText(false);
        inputRef.current.setAttribute('data-empty', 'true');

        setTimeout(() => {
          if (chatAreaRef.current) {
            chatAreaRef.current.scrollTop = chatAreaRef.current.scrollHeight + 1000;
          }
        }, 100);
      };

      return (
        <>
          <div className="relative w-full h-dvh overflow-hidden bg-white max-w-md mx-auto">
            <div className="flex items-center justify-between p-4 bg-white">
              <div 
                className="flex items-center gap-4 cursor-pointer"
                onClick={() => setShowChat(true)}
              >
                <div className="w-14 h-14 rounded-full bg-orange-400 flex items-center justify-center">
                  <span className="text-white text-xl font-semibold">DS</span>
                </div>
                <div className="flex flex-col">
                  <h3 className="text-lg font-semibold text-gray-900">Daddy Steve</h3>
                  <p className="text-base text-gray-500">Daddy Steve joined Telegram</p>
                </div>
              </div>
              <div className="text-gray-400 text-sm self-start">Oct 27</div>
            </div>

            <div 
              className={`absolute inset-0 flex flex-col bg-gray-100 transition-transform duration-300 ease-in-out ${
                showChat ? 'translate-x-0' : 'translate-x-full'
              }`}
              style={{
                paddingTop: 'env(safe-area-inset-top)',
                paddingBottom: 'env(safe-area-inset-bottom)',
              }}
            >
              <div className="flex-shrink-0 flex items-center justify-between p-3 bg-white shadow-sm">
                <div className="flex items-center gap-2">
                  <button onClick={() => setShowChat(false)} className="text-gray-600 hover:text-gray-900">
                    <ArrowLeft size={22} />
                  </button>
                  <div className="flex items-center gap-2 ml-2">
                    <div className="w-9 h-9 rounded-full bg-orange-400 flex items-center justify-center">
                      <span className="text-white text-base font-semibold">DS</span>
                    </div>
                    <div className="flex flex-col">
                      <h3 className="text-base font-semibold text-gray-900">Daddy Steve</h3>
                      <p className="text-xs text-gray-500">last seen 11/4/2025</p>
                    </div>
                  </div>
                </div>
                <button className="text-gray-600 hover:text-gray-900">
                  <MoreVertical size={22} />
                </button>
              </div>

              <div 
                ref={chatAreaRef}
                onScroll={handleScroll}
                className="flex-1 overflow-y-auto hide-scrollbar p-4"
                style={{
                  backgroundImage: 'url(https://i.ibb.co/fzG6R49y/Screenshot-20251125-105049.jpg)',
                  backgroundSize: 'cover',
                  backgroundPosition: 'center',
                  backgroundRepeat: 'no-repeat',
                }}
              >
                <div className="flex flex-col gap-1 items-end max-w-full min-h-full justify-end">
                  {messages.map((message) => {
                    const isLong = message.text.length > 50;
                    const isMedium = message.text.length > 30 && message.text.length <= 50;

                    if (isLong) {
                      return (
                        <div key={message.id} className="bg-white rounded-2xl px-3 shadow-sm" style={{ maxWidth: '290px', paddingTop: '8px', paddingBottom: '4px' }}>
                          <div style={{ fontSize: '14px', lineHeight: '1.3' }}>
                            {message.text}
                            <span style={{ 
                              float: 'right', 
                              marginLeft: '6px',
                              fontSize: '11px',
                              color: '#6b7280',
                              whiteSpace: 'nowrap',
                              display: 'inline-flex',
                              alignItems: 'center',
                              gap: '4px',
                              position: 'relative',
                              bottom: '-3px'
                            }}>
                              {message.time}
                              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 32 32"><path fill="#595959" d="M28.28 6.28L11 23.563l-7.28-7.28l-1.44 1.437l8 8l .72.686l .72-.687l18-18l-1.44-1.44z"/></svg>
                            </span>
                          </div>
                        </div>
                      );
                    }

                    if (isMedium) {
                      return (
                        <div key={message.id} className="bg-white rounded-2xl px-3 py-2 max-w-[85%] shadow-sm">
                          <div className="flex flex-col">
                            <span className="text-gray-900 text-sm">{message.text}</span>
                            <span className="text-[11px] text-gray-500 flex items-center gap-1 self-end mt-1">
                              {message.time}
                              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 32 32"><path fill="#595959" d="M28.28 6.28L11 23.563l-7.28-7.28l-1.44 1.437l8 8l .72.686l .72-.687l18-18l-1.44-1.44z"/></svg>
                            </span>
                          </div>
                        </div>
                      );
                    }

                    return (
                      <div key={message.id} className="bg-white rounded-2xl px-3 py-2 max-w-[85%] shadow-sm">
                        <div className="flex items-end gap-2 whitespace-nowrap">
                          <span className="text-gray-900 text-sm">{message.text}</span>
                          <span className="text-[11px] text-gray-500 flex items-center gap-1 flex-shrink-0">
                            {message.time}
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 32 32"><path fill="#595959" d="M28.28 6.28L11 23.563l-7.28-7.28l-1.44 1.437l8 8l .72.686l .72-.687l18-18l-1.44-1.44z"/></svg>
                          </span>
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>

              <div 
                className="absolute left-0 right-0 flex justify-end px-4 pointer-events-none transition-all duration-300" 
                style={{ 
                  bottom: showEmojiPicker ? '380px' : '80px', 
                  zIndex: 20,
                  transform: showScrollButton ? 'translateY(0)' : 'translateY(70px)',
                  opacity: showScrollButton ? 1 : 0
                }}
              >
                <button
                  onClick={() => {
                    scrollToBottom(true);
                    setShowScrollButton(false);
                  }}
                  className="bg-white rounded-full shadow-xl flex items-center justify-center hover:bg-gray-50 transition-all pointer-events-auto w-11 h-11"
                >
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6 9L12 15L18 9" stroke="#6b7280" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"/>
                  </svg>
                </button>
              </div>

              <div className="flex-shrink-0 bg-white border-t border-gray-200 relative">
                <div className="w-full max-w-2xl mx-auto flex items-center p-2 gap-1">
                  <button onClick={toggleEmojiPicker} className="p-2 flex-shrink-0 self-end">
                    {showEmojiPicker ? (
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 432 384">
                        <path fill="#6b7280" d="M384 43q18 0 30.5 12.5T427 85v214q0 17-12.5 29.5T384 341H43q-18 0-30.5-12.5T0 299V85q0-17 12.5-29.5T43 43h341zm-192 64v42h43v-42h-43zm0 64v42h43v-42h-43zm-64-64v42h43v-42h-43zm0 64v42h43v-42h-43zm-21 42v-42H64v42h43zm0-64v-42H64v42h43zm192 150v-43H128v43h171zm0-86v-42h-43v42h43zm0-64v-42h-43v42h43zm64 64v-42h-43v42h43zm0-64v-42h-43v42h43z"/>
                      </svg>
                    ) : (
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g transform="rotate(-19, 12, 12)">
                          <path d="M9 16C9.85038 16.6303 10.8846 17 12 17C13.1154 17 14.1496 16.6303 15 16" stroke="#6b7280" strokeWidth="2" strokeLinecap="round"></path>
                          <ellipse cx="15" cy="10.5" rx="1" ry="1.5" fill="#6b7280"></ellipse>
                          <ellipse cx="9" cy="10.5" rx="1" ry="1.5" fill="#6b7280"></ellipse>
                          <path d="M15 22H12C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.9282 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C22 4.92893 22 7.28595 22 12V15M15 22C18.866 22 22 18.866 22 15M15 22C15 20.1387 15 19.2081 15.2447 18.4549C15.7393 16.9327 16.9327 15.7393 18.4549 15.2447C19.2081 15 20.1387 15 22 15" stroke="#6b7280" strokeWidth="2"></path>
                        </g>
                      </svg>
                    )}
                  </button>

                  <div
                    ref={inputRef}
                    contentEditable
                    suppressContentEditableWarning={true}
                    className="flex-1 bg-transparent text-gray-900 outline-none px-3 py-2 min-h-[40px] max-h-[120px] overflow-y-auto whitespace-pre-wrap break-words"
                    data-placeholder="Message..."
                    data-empty="true"
                    onFocus={handleFocus}
                    onClick={handleClick}
                    onInput={handleInput}
                    onKeyDown={handleKeyDown}
                    style={{ paddingRight: hasText ? '50px' : '12px' }}
                  />

                  <div className="flex items-end gap-1 transition-all duration-200 overflow-hidden" 
                    style={{ width: hasText ? '0px' : 'auto', opacity: hasText ? 0 : 1, pointerEvents: hasText ? 'none' : 'auto' }}>
                    <button onMouseDown={(e) => e.preventDefault()} className="p-2"><svg fill="#6b7280" viewBox="0 0 32 32" width="24" height="24" xmlns="http://www.w3.org/2000/svg"><g transform="rotate(-42, 16, 16)"><path d="M13.17,29.9a4,4,0,0,1-2.83-1.17L4.69,23.07a4,4,0,0,1,0-5.66L18.83,3.27a4.1,4.1,0,0,1,5.66,0L27.31,6.1a4,4,0,0,1,0,5.66L16,23.07a4,4,0,0,1-5.66-5.66l9.2-9.19L21,9.64l-9.19,9.19a2,2,0,0,0,2.83,2.83L25.9,10.34a2,2,0,0,0,0-2.83L23.07,4.69a2,2,0,0,0-2.83,0L6.1,18.83a2,2,0,0,0,0,2.83l5.66,5.65a2,2,0,0,0,2.83,0l12-12L28,16.71l-12,12A4,4,0,0,1,13.17,29.9Z"></path></g></svg></button>
                    <button onMouseDown={(e) => e.preventDefault()} className="p-2"><svg viewBox="0 0 24 24" fill="none" width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C22 4.92893 22 7.28595 22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12Z" stroke="#6b7280" strokeWidth="1.5"></path><circle cx="12" cy="12" r="4" stroke="#6b7280" strokeWidth="1.5"></circle></svg></button>
                    <button onMouseDown={(e) => e.preventDefault()} className="p-2 hover:bg-gray-100 rounded-full"><svg viewBox="0 0 24 24" fill="none" stroke="#6b7280" strokeWidth="1.8" width="24" height="24" xmlns="http://www.w3.org/2000/svg"><rect x="8" y="2" width="8" height="13" rx="4"></rect><path d="M20,10v1a8,8,0,0,1-8,8h0a8,8,0,0,1-8-8V10"></path><line x1="12" y1="19" x2="12" y2="22"></line></svg></button>
                  </div>

                  {hasText && (
                    <div 
                      onClick={handleSend}
                      className="flex-shrink-0 absolute z-10 cursor-pointer right-2 bottom-2 p-2"
                    >
                      <svg viewBox="0 -0.5 21 21" width="28" height="28" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2.61258 9L0.05132 1.31623C-0.22718 0.48074 0.63218 -0.28074 1.42809 0.09626L20.4281 9.0963C21.1906 9.4575 21.1906 10.5425 20.4281 10.9037L1.42809 19.9037C0.63218 20.2807 -0.22718 19.5193 0.05132 18.6838L2.61258 11H8.9873C9.5396 11 9.9873 10.5523 9.9873 10C9.9873 9.4477 9.5396 9 8.9873 9H2.61258z" fill="#3b82f6" fillRule="evenodd" clipRule="evenodd" />
                      </svg>
                    </div>
                  )}
                </div>
              </div>

              <div 
                className="flex-shrink-0 bg-gray-100 transition-all duration-300 ease-in-out overflow-hidden"
                style={{ height: showEmojiPicker ? emojiPickerHeight : 0 }}
              >
                <div className="w-full h-full p-4">
                  {/* Intentionally empty */}
                </div>
              </div>
            </div>
          </div>
        </>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<TelegramNotification />);
  </script>
</body>
</html>

