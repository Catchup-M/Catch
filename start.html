<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Telegram Chat</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <!-- Link to SVG Icons Library -->
  <script src="svg.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
    }

    .content {
      flex: 1;
      padding: 12px 18px;
    }

    .footer {
      position: fixed;
      bottom: 56px;
      left: 0;
      right: 0;
      background: #fff;
      padding: 5px 10px;
      display: flex;
      align-items: center;
      border: none;
      z-index: 10;
      transition: bottom 0.3s ease;
      height: 56px;
    }

    .footer.emoji-open {
      bottom: 356px;
    }

    .footer svg.left-icon {
      width: 25px;
      height: 29px;
      margin-right: 10px;
      flex-shrink: 0;
      fill: #666666;
      cursor: pointer;
    }

    .footer svg.right-icon {
      width: 25px;
      height: 29px;
      margin-left: 10px;
      flex-shrink: 0;
      cursor: pointer;
    }

    .input-box-wrapper {
      flex: 1;
      display: flex;
      align-items: center;
      background: #f1f1f1;
      border-radius: 20px;
      padding: 8px 10px;
      min-height: 43px;
      max-height: 120px;
      box-sizing: border-box;
      overflow: hidden;
    }

    .input-box-wrapper svg {
      width: 21px;
      height: 21px;
      flex-shrink: 0;
      margin-right: 10px;
    }

    .input-box {
      flex: 1;
      font-size: 14px;
      line-height: 1.4;
      outline: none;
      border: none;
      background: transparent;
      min-height: 20px;
      max-height: 100px;
      overflow-y: auto;
      word-wrap: break-word;
      white-space: pre-wrap;
      overflow-x: hidden;
      width: 100%;
    }

    .input-box:empty:before {
      content: "Message";
      color: #aaa;
      pointer-events: none;
    }

    .input-box:focus:empty:before {
      content: "Message";
      color: #aaa;
    }

    .conversation-list {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: #fff;
      transition: transform 0.3s;
      z-index: 1;
    }

    .conversation-list.-translate-x-full {
      transform: translateX(-100%);
    }

    .chat-view {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: #f5f5f5;
      transition: transform 0.3s;
      transform: translateX(100%);
      z-index: 2;
      display: flex;
      flex-direction: column;
    }

    .chat-view.translate-x-0 {
      transform: translateX(0);
    }

    .emoji-picker {
      position: fixed;
      bottom: 56px;
      left: 0;
      right: 0;
      height: 300px;
      background: #f5f5f5;
      transition: transform 0.3s ease;
      transform: translateY(100%);
      z-index: 8;
      border-top: 1px solid #e5e5e5;
    }

    .emoji-picker.show {
      transform: translateY(0);
    }

    .date-separator {
      display: flex;
      justify-content: center;
      padding: 12px 0;
      position: relative;
      z-index: 5;
    }

    .date-badge {
      background: rgba(0, 0, 0, 0.6);
      color: white;
      padding: 6px 12px;
      border-radius: 12px;
      font-size: 13px;
      font-weight: 500;
      backdrop-filter: blur(10px);
    }

    .sticky-date {
      position: fixed;
      top: 60px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 15;
      opacity: 0;
      transition: opacity 0.2s ease;
      pointer-events: none;
    }

    .sticky-date.visible {
      opacity: 1;
    }

    .sticky-date .date-badge {
      background: rgba(0, 0, 0, 0.7);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    .sticky-date:empty {
      display: none;
    }

    .message-date-badge {
      display: flex;
      justify-content: center;
      padding: 8px 0;
      margin-bottom: 8px;
    }

    .message-date-badge .date-badge {
      background: rgba(0, 0, 0, 0.6);
      color: white;
      padding: 4px 10px;
      border-radius: 10px;
      font-size: 12px;
      font-weight: 500;
      backdrop-filter: blur(10px);
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useRef, useEffect } = React;

    function FooterChatBar() {
      const [isKeyboardActive, setIsKeyboardActive] = useState(false);
      const [showChat, setShowChat] = useState(false);
      const [hasText, setHasText] = useState(false);
      const [showEmojiPicker, setShowEmojiPicker] = useState(false);
      const [messages, setMessages] = useState([
        { id: 1, type: 'image', imageUrl: 'https://i.ibb.co/fKxWKb3/Screenshot-20251129-120749.jpg', time: '17:06', sent: true, date: 'Tuesday' }
      ]);
      const inputRef = useRef(null);
      const messagesEndRef = useRef(null);
      const chatContainerRef = useRef(null);
      const stickyDateRef = useRef(null);

      const toggleKeyboard = () => {
        setIsKeyboardActive(!isKeyboardActive);
        setShowEmojiPicker(!showEmojiPicker);
      };

      const openChat = () => {
        setShowChat(true);
      };

      const closeChat = () => {
        setShowChat(false);
      };

      const handleInputClick = () => {
        if (showEmojiPicker) {
          setShowEmojiPicker(false);
          setIsKeyboardActive(false);
        }
        
        const scrollToBottom = () => {
          if (chatContainerRef.current) {
            chatContainerRef.current.scrollTop = chatContainerRef.current.scrollHeight;
          }
        };
        
        scrollToBottom();
        setTimeout(scrollToBottom, 100);
        setTimeout(scrollToBottom, 300);
        setTimeout(scrollToBottom, 500);
      };

      const handleInput = (e) => {
        const text = e.currentTarget.textContent.trim();
        setHasText(text.length > 0);
        
        setTimeout(() => {
          if (chatContainerRef.current) {
            chatContainerRef.current.scrollTop = chatContainerRef.current.scrollHeight;
          }
        }, 50);
      };

      const handleBlur = (e) => {
        if (e.currentTarget.textContent.trim() === '') {
          e.currentTarget.textContent = '';
        }
      };

      const handleSend = () => {
        if (inputRef.current && hasText) {
          const text = inputRef.current.textContent.trim();
          if (text) {
            const newMessage = {
              id: messages.length + 1,
              text: text,
              time: new Date().toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' }),
              sent: true
            };
            setMessages([...messages, newMessage]);
          }
          inputRef.current.innerHTML = '';
          setHasText(false);
          inputRef.current.blur();
        }
      };

      const handleKeyDown = (e) => {
        // Disable Enter key from sending on mobile devices
      };

      useEffect(() => {
        if (showChat && messages.length > 1) {
          setTimeout(() => {
            if (chatContainerRef.current) {
              chatContainerRef.current.scrollTop = chatContainerRef.current.scrollHeight;
            }
          }, 300);
        }
      }, [messages, showChat]);

      useEffect(() => {
        if (showEmojiPicker && showChat) {
          setTimeout(() => {
            if (chatContainerRef.current) {
              chatContainerRef.current.scrollTop = chatContainerRef.current.scrollHeight;
            }
          }, 350);
        }
      }, [showEmojiPicker, showChat]);

      useEffect(() => {
        const scrollContainer = chatContainerRef.current;
        if (!scrollContainer || !showChat) return;

        const handleScroll = () => {
          const dateSeparators = scrollContainer.querySelectorAll('.date-separator, .message-date-badge');
          const stickyDate = stickyDateRef.current;
          if (!stickyDate) return;

          let shouldShowSticky = false;
          let currentDateText = '';
          const chatHeaderHeight = 65;

          dateSeparators.forEach(separator => {
            const rect = separator.getBoundingClientRect();
            
            if (rect.top <= chatHeaderHeight && rect.bottom >= 0) {
              shouldShowSticky = true;
              const badge = separator.querySelector('.date-badge');
              if (badge) {
                currentDateText = badge.textContent;
              }
            }
          });

          const stickyBadge = stickyDate.querySelector('.date-badge');
          if (shouldShowSticky && currentDateText && stickyBadge) {
            stickyBadge.textContent = currentDateText;
            stickyDate.style.opacity = '1';
            stickyDate.classList.add('visible');
          } else {
            if (stickyBadge) stickyBadge.textContent = '';
            stickyDate.style.opacity = '0';
            stickyDate.classList.remove('visible');
          }
        };

        scrollContainer.addEventListener('scroll', handleScroll);
        setTimeout(handleScroll, 100);
        
        return () => scrollContainer.removeEventListener('scroll', handleScroll);
      }, [showChat, messages]);

      return (
        <div style={{ margin: 0, fontFamily: 'Arial, sans-serif', background: '#f5f5f5', height: '100vh', display: 'flex', flexDirection: 'column', overflow: 'hidden', position: 'fixed', width: '100%', top: 0, left: 0 }}>
          {/* Conversation List */}
          <div className={`conversation-list ${showChat ? '-translate-x-full' : ''}`}>
            {/* Header with Search */}
            <div style={{ background: '#fff', borderBottom: '1px solid #e5e5e5' }}>
              <div style={{ display: 'flex', alignItems: 'center', padding: '12px 16px', gap: '12px' }}>
                <button style={{ padding: '6px', background: 'transparent', border: 'none', cursor: 'pointer' }}>
                  <span dangerouslySetInnerHTML={{ __html: window.SVGIcons.menu }} />
                </button>
                <div style={{ flex: 1, display: 'flex', alignItems: 'center', background: '#f5f5f5', borderRadius: '20px', padding: '10px 16px', gap: '8px' }}>
                  <span dangerouslySetInnerHTML={{ __html: window.SVGIcons.search }} />
                  <input 
                    type="text" 
                    placeholder="Search" 
                    style={{ flex: 1, background: 'transparent', border: 'none', outline: 'none', fontSize: '16px', color: '#333' }}
                  />
                </div>
              </div>
            </div>

            {/* Conversation Item */}
            <div 
              onClick={openChat}
              style={{ 
                display: 'flex', 
                alignItems: 'center', 
                padding: '12px 16px', 
                gap: '12px', 
                cursor: 'pointer',
                position: 'relative'
              }}
            >
              <div style={{ 
                width: '52px', 
                height: '52px', 
                borderRadius: '50%', 
                background: '#fb923c', 
                display: 'flex', 
                alignItems: 'center', 
                justifyContent: 'center', 
                flexShrink: 0 
              }}>
                <span style={{ color: 'white', fontSize: '20px', fontWeight: '600' }}>DS</span>
              </div>
              <div style={{ flex: 1, minWidth: 0, position: 'relative' }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'baseline', marginBottom: '4px' }}>
                  <h3 style={{ fontWeight: '600', color: '#111', fontSize: '16px', margin: 0 }}>Daddy Steve</h3>
                  <span style={{ color: '#999', fontSize: '13px', flexShrink: 0 }}>Oct 27</span>
                </div>
                <p style={{ color: '#666', fontSize: '14px', margin: 0, overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
                  Daddy Steve joined Telegram
                </p>
                <div style={{ 
                  position: 'absolute', 
                  bottom: '-12px', 
                  left: 0, 
                  right: '-16px', 
                  height: '1px', 
                  background: '#f0f0f0' 
                }}></div>
              </div>
            </div>
          </div>

          {/* Chat View */}
          <div className={`chat-view ${showChat ? 'translate-x-0' : ''}`}>
            {/* Chat Header */}
            <div style={{ background: '#fff', borderBottom: '1px solid #e5e5e5' }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '8px', padding: '8px' }}>
                <button 
                  onClick={closeChat}
                  style={{ padding: '6px', background: 'transparent', border: 'none', cursor: 'pointer', borderRadius: '4px' }}
                >
                  <span dangerouslySetInnerHTML={{ __html: window.SVGIcons.backArrow }} />
                </button>
                <div style={{ width: '40px', height: '40px', borderRadius: '50%', background: '#fb923c', display: 'flex', alignItems: 'center', justifyContent: 'center', flexShrink: 0 }}>
                  <span style={{ color: 'white', fontSize: '16px', fontWeight: '600' }}>DS</span>
                </div>
                <div style={{ flex: 1, minWidth: 0 }}>
                  <h3 style={{ fontWeight: '600', color: '#111827', fontSize: '18px', margin: 0 }}>Daddy Steve</h3>
                  <p style={{ color: '#6b7280', fontSize: '14px', margin: 0 }}>last seen 11/3/2025</p>
                </div>
                <button style={{ padding: '6px', background: 'transparent', border: 'none', cursor: 'pointer', borderRadius: '4px' }}>
                  <span dangerouslySetInnerHTML={{ __html: window.SVGIcons.threeDots }} />
                </button>
              </div>
            </div>

            {/* Sticky Date at Top */}
            <div className="sticky-date" ref={stickyDateRef}>
              <div className="date-badge"></div>
            </div>

            <div 
              ref={chatContainerRef}
              style={{ 
              flex: 1,
              backgroundImage: 'url(https://i.ibb.co/fzG6R49y/Screenshot-20251125-105049.jpg)', 
              backgroundSize: 'cover', 
              backgroundPosition: 'center', 
              backgroundRepeat: 'no-repeat',
              backgroundColor: '#f5f5f5',
              overflowY: 'auto',
              overflowX: 'hidden',
              display: 'flex',
              flexDirection: 'column'
            }}>
              <div style={{ 
                flex: 1,
                minHeight: 'min-content'
              }}></div>
              <div style={{
                padding: '16px',
                paddingBottom: showEmojiPicker ? '420px' : '120px',
                display: 'flex',
                flexDirection: 'column',
                gap: '8px',
                transition: 'padding-bottom 0.3s ease'
              }}>

              {messages.map((message) => {
                if (message.type === 'image') {
                  return (
                    <React.Fragment key={message.id}>
                      {message.date && (
                        <div className="message-date-badge">
                          <div className="date-badge">{message.date}</div>
                        </div>
                      )}
                      <div style={{ display: 'flex', justifyContent: 'flex-end' }}>
                        <div style={{ 
                          background: 'white', 
                          borderRadius: '16px 1px 1px 16px', 
                          padding: '4px',
                          boxShadow: '0 1px 2px rgba(0,0,0,0.1)',
                          maxWidth: '290px',
                          position: 'relative'
                        }}>
                          <img 
                            src={message.imageUrl} 
                            alt="Sent image" 
                            style={{ 
                              width: '100%', 
                              display: 'block', 
                              borderRadius: '12px',
                              maxWidth: '290px'
                            }} 
                          />
                          <div style={{ 
                            position: 'absolute',
                            bottom: '12px',
                            right: '12px',
                            fontSize: '11px',
                            color: 'white',
                            textShadow: '0 1px 2px rgba(0,0,0,0.6)',
                            display: 'flex',
                            alignItems: 'center',
                            gap: '4px'
                          }}>
                            {message.time}
                            {message.sent && (
                              <span dangerouslySetInnerHTML={{ __html: window.SVGIcons.checkmark }} style={{ filter: 'drop-shadow(0 1px 2px rgba(0,0,0,0.6))' }} />
                            )}
                          </div>
                        </div>
                      </div>
                    </React.Fragment>
                  );
                }
                
                const isLongMessage = message.text.length > 50;
                const isMediumMessage = message.text.length > 30 && message.text.length <= 50;
                
                return (
                  <div key={message.id} style={{ display: 'flex', justifyContent: 'flex-end' }}>
                    {isLongMessage ? (
                      <div style={{ 
                        background: 'white', 
                        borderRadius: '16px 1px 1px 16px', 
                        padding: '8px 12px 4px 12px',
                        boxShadow: '0 1px 2px rgba(0,0,0,0.1)',
                        maxWidth: '290px'
                      }}>
                        <div style={{ fontSize: '14px', lineHeight: '1.3', color: '#111' }}>
                          {message.text}
                          <span style={{ 
                            float: 'right', 
                            marginLeft: '6px',
                            fontSize: '11px',
                            color: '#6b7280',
                            whiteSpace: 'nowrap',
                            display: 'inline-flex',
                            alignItems: 'center',
                            gap: '4px',
                            position: 'relative',
                            bottom: '-5px'
                          }}>
                            {message.time}
                            {message.sent && (
                              <span dangerouslySetInnerHTML={{ __html: window.SVGIcons.checkmarkGray }} style={{ position: 'relative', top: '-2px' }} />
                            )}
                          </span>
                        </div>
                      </div>
                    ) : isMediumMessage ? (
                      <div style={{ 
                        background: 'white', 
                        borderRadius: '16px 1px 1px 16px', 
                        padding: '8px 12px 4px 12px',
                        boxShadow: '0 1px 2px rgba(0,0,0,0.1)',
                        maxWidth: '85%'
                      }}>
                        <div style={{ fontSize: '14px', lineHeight: '1.3', color: '#111' }}>
                          {message.text}
                          <span style={{ 
                            float: 'right', 
                            marginLeft: '6px',
                            fontSize: '11px',
                            color: '#6b7280',
                            whiteSpace: 'nowrap',
                            display: 'inline-flex',
                            alignItems: 'center',
                            gap: '4px',
                            position: 'relative',
                            bottom: '-5px'
                          }}>
                            {message.time}
                            {message.sent && (
                              <span dangerouslySetInnerHTML={{ __html: window.SVGIcons.checkmarkGray }} style={{ position: 'relative', top: '-2px' }} />
                            )}
                          </span>
                        </div>
                      </div>
                    ) : (
                      <div style={{ 
                        background: 'white', 
                        borderRadius: '16px 1px 1px 16px', 
                        padding: '8px 12px',
                        boxShadow: '0 1px 2px rgba(0,0,0,0.1)',
                        maxWidth: '85%'
                      }}>
                        <div style={{ display: 'flex', alignItems: 'flex-end', gap: '8px', whiteSpace: 'nowrap' }}>
                          <span style={{ color: '#111', fontSize: '14px' }}>{message.text}</span>
                          <span style={{ 
                            fontSize: '11px', 
                            color: '#6b7280', 
                            display: 'flex', 
                            alignItems: 'center', 
                            gap: '4px',
                            flexShrink: 0
                          }}>
                            {message.time}
                            {message.sent && (
                              <span dangerouslySetInnerHTML={{ __html: window.SVGIcons.checkmarkGray }} style={{ position: 'relative', top: '-1px' }} />
                            )}
                          </span>
                        </div>
                      </div>
                    )}
                  </div>
                );
              })}
              <div ref={messagesEndRef} />
              </div>
            </div>

            {/* Emoji Picker Bottom Sheet */}
            <div className={`emoji-picker ${showEmojiPicker ? 'show' : ''}`}>
            </div>

            <div className={`footer ${showEmojiPicker ? 'emoji-open' : ''}`}>
              <span className="left-icon" dangerouslySetInnerHTML={{ __html: window.SVGIcons.attachmentClip }} />

              <div className="input-box-wrapper">
                {isKeyboardActive ? (
                  <span dangerouslySetInnerHTML={{ __html: window.SVGIcons.keyboard }} onClick={toggleKeyboard} style={{ cursor: 'pointer' }} />
                ) : (
                  <span dangerouslySetInnerHTML={{ __html: window.SVGIcons.emoji }} onClick={toggleKeyboard} style={{ cursor: 'pointer' }} />
                )}
                <div 
                  ref={inputRef}
                  className="input-box" 
                  contentEditable="true"
                  onInput={handleInput}
                  onBlur={handleBlur}
                  onKeyDown={handleKeyDown}
                  onClick={handleInputClick}
                  onFocus={handleInputClick}
                  suppressContentEditableWarning={true}
                ></div>
              </div>

              {!hasText && (
                <span className="right-icon" dangerouslySetInnerHTML={{ __html: window.SVGIcons.microphone }} />
              )}

              {hasText && (
                <button 
                  onClick={handleSend}
                  style={{
                    background: 'transparent',
                    border: 'none',
                    cursor: 'pointer',
                    width: '25px',
                    height: '29px',
                    marginLeft: '10px',
                    flexShrink: 0,
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center'
                  }}
                >
                  <span dangerouslySetInnerHTML={{ __html: window.SVGIcons.send }} />
                </button>
              )}
            </div>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<FooterChatBar />);
  </script>
</body>
</html>
